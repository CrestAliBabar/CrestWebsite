"use client";

import React from "react";
import { AlertTriangle, CheckCircle, XCircle, Info, HelpCircle } from "lucide-react";
import { Tooltip, TooltipTrigger, TooltipContent } from "./tooltip";

const vulnerabilityData = [
  { name: "CVE-2024-51479", discovered: "2025-01-31", cvss: "7.5", dependency: "next (npm)", reviewStatus: "Critical" },
  { name: "CVE-2024-21538", discovered: "2025-01-31", cvss: "7.5", dependency: "cross-spawn (npm)", reviewStatus: "High" },
  { name: "CVE-2024-47831", discovered: "2025-01-31", cvss: "7.5", dependency: "next (npm)", reviewStatus: "Medium" },
  { name: "CVE-2024-46982", discovered: "2025-01-31", cvss: "7.5", dependency: "next (npm)", reviewStatus: "Low" },
  { name: "CVE-2024-37890", discovered: "2025-01-31", cvss: "7.5", dependency: "ws (npm)", reviewStatus: "Unknown" },
  { name: "CVE-2024-4068", discovered: "2025-01-31", cvss: "7.5", dependency: "braces (npm)", reviewStatus: "High" },
];

const statusIcons: Record<string, JSX.Element> = {
  Critical: <XCircle className="text-red-600" />,
  High: <AlertTriangle className="text-orange-500" />,
  Medium: <Info className="text-yellow-500" />,
  Low: <CheckCircle className="text-green-500" />,
  Unknown: <HelpCircle className="text-gray-500" />,
};

export function VulnerabilityTable() {
  return (
    <div className="bg-[white] rounded-xl p-6 shadow-md">
      <h3 className="text-sm font-medium text-[#325C6C] mb-4">Vulnerability Table</h3>
      <div className="overflow-x-auto">
        <table className="w-full text-left border-collapse">
          <thead>
            <tr className="bg-[#DCEEF1] text-[#325C6C]">
              <th className="px-4 py-2">Name</th>
              <th className="px-4 py-2">Discovered</th>
              <th className="px-4 py-2">CVSS</th>
              <th className="px-4 py-2">Dependency</th>
              <th className="px-4 py-2">Review Status</th>
            </tr>
          </thead>
          <tbody>
            {vulnerabilityData.map((item, index) => (
              <tr key={index} className="border-t hover:bg-[#BDDDE4] transition-colors">
                <td className="px-4 py-2 text-[#325C6C] font-medium">{item.name}</td>
                <td className="px-4 py-2">{item.discovered}</td>
                <td className="px-4 py-2 text-[#D4A017] font-semibold">{item.cvss}</td>
                <td className="px-4 py-2">{item.dependency}</td>
                <td className="px-4 py-2 flex items-center gap-2">
                  <Tooltip>
                    <TooltipTrigger>{statusIcons[item.reviewStatus] || <HelpCircle className="text-gray-500" />}</TooltipTrigger>
                    <TooltipContent>{item.reviewStatus}</TooltipContent>
                  </Tooltip>
                  <span>{item.reviewStatus}</span>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}
